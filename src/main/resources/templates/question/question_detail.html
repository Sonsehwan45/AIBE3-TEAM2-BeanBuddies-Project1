<html layout:decorate="~{layout}">
    <div layout:fragment="content" class="container my-3">
        <th:block th:object="${question}">
            <h1 th:text="${question.title}">질문 제목</h1>
            <p th:text="${question.content}">질문 내용</p>
            <p>작성일: <span th:text="${#temporals.format(question.createDate, 'yyyy-MM-dd HH:mm')}">작성일</span></p>

            <!-- 답변 화면 -->
            <div>
                <h3>답변</h3>
                <!-- 등록된 답변 나열 -->
                <div th:each="answer : *{answers}" class="">
                    <span th:text="${answer.content}"></span> /
                    <span th:text="${#temporals.format(answer.createDate, 'yyyy-MM-dd HH:mm')}"></span> /
                    <a th:href="|/answer/modify/${answer.id}|">수정</a> /
                    <form th:action="@{|/answer/delete/${answer.id}|}" method="post" style="display:inline;">
                        <input type="hidden" name="_method" value="delete"/>
                        <button type="submit" class="btn btn-link" style="padding:0; border:none; background:none;">
                            삭제
                        </button>
                    </form>
                </div>
                <!-- 신규 답변 등록창 -->
                <h4>등록</h4>
                <th:block th:object="${answerForm}">
                    <form action="/answer/write" method="post">
                        <div class="d-flex">
                            <input type="text" th:field="*{content}" class="form-control"/>
                            <input type="hidden" th:field="*{questionId}">
                            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                            <button type="submit" class="btn btn-primary">등록</button>
                        </div>
                        <div th:if="${#fields.hasErrors('content')}" class="text-danger" th:errors="*{content}"></div>
                    </form>
                </th:block>
            </div>

            <a href="/question/list" class="btn btn-secondary">목록으로</a>
            <a th:href="@{|/question/modify/${question.id}|}" class="btn btn-primary">수정</a>
            <form th:action="@{|/question/delete/${question.id}|}" method="post" style="display:inline;">
                <input type="hidden" name="_method" value="delete"/>
                <button type="submit" class="btn btn-danger"
                        onclick="return confirm('정말 삭제하시겠습니까?');">삭제</button>
            </form>
        </th:block>
    </div>
</html>